# ‚úÖ Checklist Final - Preparaci√≥n para Pruebas

## üìã Pre-Validaci√≥n

### Archivos Creados
- [ ] `terraform/backends/test-dev.tfbackend`
- [ ] `terraform/environments/test-dev.tfvars`
- [ ] `scripts/validate.sh`
- [ ] `docs/TESTING_GUIDE.md`

### Credenciales Configuradas
- [ ] `subscription_id` en tfvars o variables de entorno
- [ ] `tenant_id` en tfvars o variables de entorno
- [ ] `client_id` en tfvars o variables de entorno
- [ ] `client_secret` en tfvars o variables de entorno

---

## üîß Validaci√≥n de M√≥dulos

### M√≥dulos Principales
- [ ] `modules/resource_group/` - main.tf, variables.tf, outputs.tf
- [ ] `modules/storage_account/` - main.tf, variables.tf, outputs.tf
- [ ] `modules/service_bus/` - main.tf, variables.tf, outputs.tf
- [ ] `modules/cosmos_db/` - main.tf, variables.tf, outputs.tf
- [ ] `modules/key_vault/` - main.tf, variables.tf, outputs.tf
- [ ] `modules/api_management/` - main.tf, variables.tf, outputs.tf
- [ ] `modules/signalr/` - main.tf, variables.tf, outputs.tf
- [ ] `modules/vnet/` - main.tf, variables.tf, outputs.tf
- [ ] `modules/log_analytics_workspace/` - main.tf, variables.tf, outputs.tf
- [ ] `modules/function_app/linux/` - main.tf, variables.tf, outputs.tf
- [ ] `modules/function_app/windows/` - main.tf, variables.tf, outputs.tf
- [ ] `modules/front_door/` - main.tf, variables.tf, outputs.tf

---

## üìù Validaci√≥n del Root

### Archivos Root
- [ ] `terraform/main.tf` - Incluye todos los m√≥dulos
- [ ] `terraform/variables.tf` - Incluye todas las variables
- [ ] `terraform/outputs.tf` - Incluye todos los outputs
- [ ] `terraform/providers.tf` - Configuraci√≥n de providers

### Integraci√≥n de M√≥dulos en main.tf
- [ ] `module "resource_group"`
- [ ] `module "storage_account"`
- [ ] `module "service_bus"`
- [ ] `module "cosmos_db"`
- [ ] `module "key_vault"`
- [ ] `module "api_management"`
- [ ] `module "signalr"`
- [ ] `module "vnet"`
- [ ] `module "log_analytics"`
- [ ] `module "function_linux"`
- [ ] `module "azure_functions_windows"`
- [ ] `module "front_door"`

---

## üéØ Ajustes Necesarios en tfvars

### Nombres √önicos (deben ser globalmente √∫nicos)
- [ ] `storage_accounts.website.name` - Ejemplo: `st<tu-nombre>devweb`
- [ ] `storage_accounts.data.name` - Ejemplo: `st<tu-nombre>devdata`
- [ ] `cosmos_db.account_name` - Ejemplo: `cosmos-<tu-nombre>-dev`
- [ ] `key_vault.name` - Ejemplo: `kv-<tu-nombre>-dev` (max 24 chars)
- [ ] `front_door.name` - Ejemplo: `fd-<tu-nombre>-dev`

### Endpoints de Storage (seg√∫n regi√≥n)
- [ ] `front_door.origins.storage_web.host_name`
  - East US: `.z13.web.core.windows.net`
  - East US 2: `.z20.web.core.windows.net`
  - West US: `.z22.web.core.windows.net`

---

## üöÄ Comandos de Validaci√≥n

### 1. Validar Scripts
```bash
chmod +x scripts/*.sh
./scripts/validate.sh
```

### 2. Verificar Formato
```bash
cd terraform
terraform fmt -recursive
```

### 3. Validar Sintaxis
```bash
terraform validate
```

### 4. Verificar Backend Config
```bash
cat backends/test-dev.tfbackend
# Verificar que los nombres coincidan con lo que crear√° setup-backend.sh
```

---

## ‚ö†Ô∏è Validaciones Cr√≠ticas

### Antes de terraform init
- [ ] Backend Storage NO existe a√∫n (se crear√° con setup-backend.sh)
- [ ] Nombres en tfvars son √∫nicos globalmente
- [ ] Credenciales de Azure configuradas

### Antes de terraform plan
- [ ] Backend Storage creado exitosamente
- [ ] terraform init ejecutado sin errores
- [ ] tfvars editado con valores reales

### Antes de terraform apply
- [ ] Plan revisado completamente
- [ ] Plan muestra "0 to destroy" (en deploy inicial)
- [ ] Recursos a crear son los esperados
- [ ] No hay errores en el plan

---

## üìä M√©tricas de √âxito

### Deploy Inicial M√≠nimo
- Recursos esperados: ~5-7
  - 1 Resource Group
  - 2 Storage Accounts
  - 1 Log Analytics Workspace
  - Otros opcionales

### Deploy Completo
- Recursos esperados: ~30-50
  - Todos los m√≥dulos habilitados
  - Functions, Service Bus, Cosmos, etc.

---

## üêõ Troubleshooting Com√∫n

### Error: "Backend initialization required"
```bash
terraform init -backend-config=backends/test-dev.tfbackend -reconfigure
```

### Error: "Name already exists"
```bash
# Cambiar nombres √∫nicos en test-dev.tfvars
```

### Error: "Authentication failed"
```bash
# Verificar credenciales
az login
# O configurar variables de entorno
```

### Plan muestra "to destroy" inesperadamente
```bash
# NO APLICAR - Revisar:
# 1. ¬øCambiaste alg√∫n nombre?
# 2. ¬øEl create flag est√° correcto?
# 3. terraform state list
```

---

## ‚úÖ Ready to Test

Una vez completado este checklist:

1. ‚úÖ Todos los m√≥dulos validados
2. ‚úÖ Archivos de configuraci√≥n creados
3. ‚úÖ Nombres √∫nicos ajustados
4. ‚úÖ Credenciales configuradas
5. ‚úÖ Scripts de validaci√≥n pasan

**¬°Est√°s listo para empezar las pruebas!**

Siguiente paso: `docs/TESTING_GUIDE.md`
